(function(n){var i=n("#key"),t={},r;t.cstRegId=i.attr("data-cstregid");n.ajax({url:"/SearchCust/GetCusUpdateId",type:"get",dataType:"json",data:{regId:i.attr("data-regid"),cstRegId:i.attr("data-cstregid")},success:function(t){if(t&&t.success===!0){var i=t.data;n("#cst-name").val(i.customerNameOld);n("#cst-phone").val(i.customerPhoneOld);n("#cst-identity-typeName").val(i.customerIdentityTypeNameOld);n("#cst-identity-no").val(i.customerIdentityNoOld);n("#txt-cst-name").val(i.customerName);n("#txt-cst-phone").val(i.customerPhone);n("#cbo-cst-identity-type").val(i.customerIdentityType);n("#txt-cst-identity-no").val(i.customerIdentityNo);n("#txt-tnv-description").val(i.description);n("#cst-createName").val(i.createName);n("#cst-createFullName").val(i.createFullName);n("#cst-statusName").val(i.statusName);n("#dvkh-description").val(i.approveDesc);i.status!=="WAITING"&&(n("#checked").removeClass("display-none"),n(".evn-edit").prop("disabled",!1))}else notifyDanger(t.message)},error:function(n){console.log(n.responseText)}}).always(function(){});r=n("#frm-check-customer");n(document).ready(function(){r.validate();n(document).on("change","#cbo-cst-identity-type",function(){var i=n(this).val(),r=n(this),t=n("#txt-cst-identity-no");r.rules("remove","required");r.rules("add",{required:!0,messages:{required:"Vui lòng chọn"}});i==="CMND"?(t.rules("remove","validIdCitizen"),t.rules("remove","validPassport"),t.rules("remove","validEvn"),t.rules("add",{required:!0,validIdCard:!0,messages:{required:"Vui lòng nhập"}})):i==="CCCD"?(t.rules("remove","validIdCard"),t.rules("remove","validPassport"),t.rules("remove","validEvn"),t.rules("add",{required:!0,validIdCitizen:!0,messages:{required:"Vui lòng nhập"}})):i==="PASSPORT"?(t.rules("remove","validIdCard"),t.rules("remove","validIdCitizen"),t.rules("remove","validEvn"),t.rules("add",{required:!0,validPassport:!0,messages:{required:"Vui lòng nhập"}})):(t.rules("remove","validIdCard"),t.rules("remove","validIdCitizen"),t.rules("remove","validPassport"),t.rules("remove","validEvn"),t.rules("add",{required:!0,messages:{required:"Vui lòng nhập"}}))});n(document).on("input","#txt-cst-name",function(){var t=n(this),i=t[0].selectionStart;n(this).val(function(n,t){return t.toUpperCase()});t[0].selectionStart=t[0].selectionEnd=i});n(document).on("click","#btn-update-cust",function(){n("#txt-cst-phone").rules("add",{required:!0,validphone:!0,messages:{required:"Vui lòng nhập"}});r.valid()===!0&&(t.customerName=n.trim(n("#txt-cst-name").val()),t.customerPhone=n.trim(n("#txt-cst-phone").val()),t.customerIdentityType=n("#cbo-cst-identity-type").val(),t.customerIdentityTypeName=n("#cbo-cst-identity-type option:selected").text(),t.customerIdentityNo=n.trim(n("#txt-cst-identity-no").val()),t.description=n.trim(n("#txt-tnv-description").val()),n.ajax({url:"/SearchCust/UpdateCust",type:"post",dataType:"json",data:t,success:function(n){n&&n.success===!0?notifySuccess("Gửi yêu cầu cập nhật thông tin thành công","/SearchCust"):notifyDanger(n.message)},error:function(n){console.log(n.responseText)}}).always(function(){}))})})})(jQuery);