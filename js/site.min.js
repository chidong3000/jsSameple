function bindSearchInfoPartial(){$(document).on("change","#cboAreas",function(){loadBranchs();loadUsers()});$(document).on("change","#cboBranchs",function(){loadUsers()});$(document).on("change","#cboUsers",function(){setUserName()})}function loadAreas(){$("#cboAreas").html("");$.ajax({dataType:"json",url:"/Dictionary/GetAreas",success:function(n){if(n&&n.success===!0){var t=n.data;$("#cboAreas").append($("<option><\/option>").val("").html(defaultSelect));$.each(t,function(n,t){window.currentAreaId===t.code?$("#cboAreas").append($("<option><\/option>").val(t.code).html(t.name).attr("selected",!0)):$("#cboAreas").append($("<option><\/option>").val(t.code).html(t.name))});loadBranchs()}}})}function loadBranchs(){$("#cboBranchs").html("");var n=$("#cboAreas").val();isEmpty(n)===!1&&$.ajax({dataType:"json",url:"/Dictionary/GetBranchs",data:{areaId:n},success:function(n){if(n&&n.success===!0){var t=n.data;$("#cboBranchs").append($("<option><\/option>").val("").html(defaultSelect));$.each(t,function(n,t){window.currentBranchId===t.code?$("#cboBranchs").append($("<option><\/option>").val(t.code).html(t.name).attr("selected",!0)):$("#cboBranchs").append($("<option><\/option>").val(t.code).html(t.name))});loadUsers()}}})}function loadUsers(){$("#cboUsers").html("");$("#txtUser").val("");var n=$("#cboBranchs").val(),t=$("#cboAreas").val();isEmpty(n)===!1&&isEmpty(t)===!1&&$.ajax({dataType:"json",url:"/Dictionary/GetUsers",data:{branchId:n,areaId:t,managerId:""},success:function(n){if(n&&n.success===!0){var t=n.data;$("#cboUsers").append($("<option><\/option>").val("").html(defaultSelect));$.each(t,function(n,t){window.currentUserId===t.code?$("#cboUsers").append($(`<option data-name='${t.name}'></option>`).val(t.code).html(t.userName).attr("selected",!0)):$("#cboUsers").append($(`<option data-name='${t.name}'></option>`).val(t.code).html(t.userName))});setUserName()}}})}function setUserName(){$("#txtUser").val($("#cboUsers option:selected").attr("data-name"))}function isEmpty(n){return n===null||n===""||typeof n=="undefined"}function notifySuccess(n,t=""){$.alert({title:"Thông báo thành công",content:n,type:"green",typeAnimated:!0,buttons:{ok:{text:"Đồng ý",btnClass:"btn-green",keys:["enter","shift"],action:function(){t!==""&&$(location).attr("href",t)}}}})}function notifyDanger(n){$.alert({title:"Cảnh báo",content:n,type:"red",typeAnimated:!0,buttons:{ok:{text:"Đồng ý",btnClass:"btn-red",keys:["enter","shift"],action:function(){}}}})}function notifyInfo(n){$.alert({title:"Thông báo",content:n,type:"blue",typeAnimated:!0,buttons:{ok:{text:"Đồng ý",btnClass:"btn-blue",keys:["enter","shift"],action:function(){}}}})}function notifyWarning(n){$.alert({title:"Cảnh báo",content:n,type:"orange",typeAnimated:!0,buttons:{ok:{text:"Đồng ý",btnClass:"btn-orange",keys:["enter","shift"],action:function(){}}}})}function blockUI(){$.blockUI({message:"Đang xử lý...",css:{border:"none",padding:"15px",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px",opacity:.5,color:"#fff"}})}function unblockUI(){$.unblockUI()}function formatNumber(n){return n?n.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1."):"0"}function formatDate(n){return moment(n,"YYYYMMDD",!0).isValid()?moment(n,"YYYYMMDD").format("DD/MM/YYYY"):""}function formatDateTime(n){return moment(n,"YYYYMMDDHHmmss",!0).isValid()?moment(n,"YYYYMMDDHHmmss").format("DD/MM/YYYY HH:mm:ss"):""}function readDozens(n,t){var i="",u=Math.floor(n/10),r=n%10;return u>1?(i=" "+arrayNumber[u]+" mươi",r===1&&(i+=" mốt")):u===1?(i=" mười",r===1&&(i+=" một")):t&&r>0&&(i=" lẻ"),r===5&&u>1?i+=" lăm":(r>1||r===1&&u===0)&&(i+=" "+arrayNumber[r]),i}function readBlock(n,t){var i=Math.floor(n/100);return n=n%100,t||i>0?" "+arrayNumber[i]+" trăm"+readDozens(n,!0):readDozens(n,!1)}function readMillions(n,t){var i="",u=Math.floor(n/1e6),r;return n=n%1e6,u>0&&(i=readBlock(u,t)+" triệu",t=!0),r=Math.floor(n/1e3),n=n%1e3,r>0&&(i+=readBlock(r,t)+" nghìn",t=!0),n>0&&(i+=readBlock(n,t)),i}function parseNumberToWord(n){var t,i,r;if(n===0)return arrayNumber[0]+" đồng";t="";i="";do r=n%1e9,n=Math.floor(n/1e9),t=n>0?readMillions(r,!0)+i+t:readMillions(r,!1)+i+t,i=" tỷ";while(n>0);return t+" đồng"}function GetDistricts(n,t){t.html("");var i=n.val();isEmpty(i)===!1&&$.ajax({dataType:"json",url:"/Dictionary/GetDistricts",data:{city:i},success:function(n){if(n&&n.success===!0){var i=n.data;t.append($("<option><\/option>").val("").html(defaultSelect));$.each(i,function(n,i){window.currentBranchId===i.code?t.append($("<option><\/option>").val(i.code).html(i.name).attr("selected",!0)):t.append($("<option><\/option>").val(i.code).html(i.name))})}}})}function validatePhone(n){return n.match(/((09|03|07|08|05)+([0-9]{8})\b)/g)?!0:!1}function validateOTP(n){return n.match(/((09|03|07|08|05)+([0-9]{8})\b)/g)?!0:!1}function validIdentity(n){return n.match(/^[0-9]{9}$/)?!0:!1}function serializeData(n,t){for(var r,u,f=[],i=0;i<t.length;i++){r=t[i];for(u in r)r.hasOwnProperty(u)&&f.push({name:n+"["+i+"]."+u+"",value:r[u]})}return f}function setProgressBar(n){var t=parseFloat(100/steps)*n;t=t.toFixed();$(".progress-bar").css("width",t+"%")}function nextStep(n){currentFs=n.parent();nextFs=n.parent().next();$("#progressbar li").eq($("fieldset").index(nextFs)).addClass("active");nextFs.show();currentFs.animate({opacity:0},{step:function(n){opacity=1-n;currentFs.css({display:"none",position:"relative"});nextFs.css({opacity:opacity})},duration:500});setProgressBar(++current)}function previousStep(n){currentFs=n.parent();previousFs=n.parent().prev();$("#progressbar li").eq($("fieldset").index(currentFs)).removeClass("active");previousFs.show();currentFs.animate({opacity:0},{step:function(n){opacity=1-n;currentFs.css({display:"none",position:"relative"});previousFs.css({opacity:opacity})},duration:500});setProgressBar(--current)}function initAutonumeric(){AutoNumeric.multiple(".autonumeric-integer",autoNumericOptions)}function bindDivisionUnitDept(){$(document).on("change","#cboDivision",function(){loadUnit();loadDepartment()});$(document).on("change","#cboUnit",function(){loadDepartment()})}function loadDivision(){var n=$("#cboDivision");n.html("");$.ajax({dataType:"json",url:"/Dictionary/GetDivision",success:function(t){if(t&&t.success===!0){var i=t.data;n.append($("<option><\/option>").val("").html(defaultSelect));$.each(i,function(t,i){window.currentAreaId===i.code?n.append($("<option><\/option>").val(i.code).html(i.name).attr("selected",!0)):n.append($("<option><\/option>").val(i.code).html(i.name))});loadUnit();loadDepartment()}}})}function loadUnit(){var n=$("#cboUnit"),i=$("#cboDivision"),t;n.html("");t=i.val();isEmpty(t)===!1&&$.ajax({dataType:"json",url:"/Dictionary/GetUnit",data:{divisionId:t},success:function(t){if(t&&t.success===!0){var i=t.data;n.append($("<option><\/option>").val("").html(defaultSelect));$.each(i,function(t,i){window.currentBranchId===i.code?n.append($("<option><\/option>").val(i.code).html(i.name).attr("selected",!0)):n.append($("<option><\/option>").val(i.code).html(i.name))});loadDepartment()}}})}function loadDepartment(){var n=$("#cboDepartment"),r=$("#cboUnit"),u=$("#cboDivision"),t,i;n.html("");t=r.val();i=u.val();isEmpty(t)===!1&&$.ajax({dataType:"json",url:"/Dictionary/GetDepartment",data:{divisionId:i,unitId:t},success:function(t){if(t&&t.success===!0){var i=t.data;n.append($("<option><\/option>").val("").html(defaultSelect));$.each(i,function(t,i){window.currentBranchId===i.code?n.append($("<option><\/option>").val(i.code).html(i.name).attr("selected",!0)):n.append($("<option><\/option>").val(i.code).html(i.name))})}}})}function printInvoicePayInto(n,t){$.ajax({dataType:"html",type:"get",url:"/PayInto/PrintInvoicePayInto",data:{transType:t,id:n},success:function(n){$("#data-invoice").html("").html(n);$("#data-invoice").print({globalStyles:!1,mediaPrint:!1,stylesheet:"/css/print-invoice.css",iframe:!1,noPrintSelector:".avoid-this",prepend:"",append:"",deferred:$.Deferred().done(function(){location.reload()})})}})}function printInvoiceWithdraw(n){$.ajax({dataType:"html",type:"post",url:"/Withdraw/PrintWithdraw",data:{id:n},success:function(n){$("#data-withdraw-info").html("").html(n);$("#data-withdraw-info").print({globalStyles:!1,mediaPrint:!1,stylesheet:"/css/print-invoice.css",iframe:!1,noPrintSelector:".avoid-this",prepend:"",append:"",deferred:$.Deferred().done(function(){location.reload()})})}})}function myDataTable(n,t=10){return n.DataTable({pageLength:t,paging:!0,info:!0,retrieve:!0,lengthChange:!1,searching:!1,ordering:!1,autoWidth:!1,pagingType:"full_numbers",language:{info:"Đang xem _PAGE_/_PAGES_",paginate:{first:"«",previous:"‹",next:"›",last:"»"}}}).rows().remove().draw()}var defaultSelect="-- Vui lòng chọn --",errorClass,validClass,arrayNumber,currentFs,nextFs,previousFs,opacity,current,steps,autoNumericOptions;$(document).ready(function(){$(document).ajaxError(function(n,t){t.status===401?location.reload():unblockUI()});$(document).ajaxStart(function(){blockUI()});$(document).ajaxStop(function(){unblockUI()});var n=$(".start-style");$(window).scroll(function(){var t=$(window).scrollTop();t>=10?n.removeClass("start-style").addClass("scroll-on"):n.removeClass("scroll-on").addClass("start-style")});$("body.hero-anime").removeClass("hero-anime");$(".navbar-nav .nav-link").filter(function(){var n=location.pathname.split("/")[1];return n===""?this.href===location.href:this.href.indexOf(n)!==-1}).parent().addClass("active").siblings().removeClass("active");$(".navbar-nav .nav-link").click(function(){$(".navbar-nav .nav-item").removeClass("active");$(this).closest("li").addClass("active")});$(document).on("click",".card-header span.clickable",function(){var n=$(this);n.hasClass("card-collapsed")?(n.parents(".card").find(".card-body").slideDown(),n.removeClass("card-collapsed"),n.find("i").removeClass("fas fa-chevron-up").addClass("fas fa-chevron-down")):(n.parents(".card").find(".card-body").slideUp(),n.addClass("card-collapsed"),n.find("i").removeClass("fas fa-chevron-down").addClass("fas fa-chevron-up"))});$(".use-select2").select2({selectOnClose:!0});$('input[type="file"]').change(function(n){var t=n.target.files[0].name;$(n.target).siblings(".custom-file-label").html(t)});$(document).on("click",".btn-download",function(){var t,n;blockUI();t=$(this).attr("data-filename");t&&(n=new XMLHttpRequest,n.open("get",`/Dictionary/Download?fileName=${t}`,!0),n.responseType="blob",n.onload=function(){var t=n.response,i=URL.createObjectURL(t);unblockUI();$(".modal-content-image").prop("src",i);$("#modal-image").modal("show")},n.send(null))});$('.readonly input[type="text"]:not(.non-readonly)').attr("disabled",!0);$('.readonly input[type="radio"]:not(.non-readonly)').attr("disabled",!0);$('.readonly input[type="checkbox"]:not(.non-readonly)').attr("disabled",!0);$(".readonly select:not(.non-readonly)").attr("disabled",!0);$(".readonly textarea:not(.non-readonly)").attr("disabled",!0);$(".readonly span.text-danger").hide();initAutonumeric()});errorClass="is-invalid";validClass="is-valid";jQuery.validator.setDefaults({onkeyup:!1,highlight:function(n){var t=$(n),i;t.closest(".item-validate")?(i=t.closest(".item-validate"),i.removeClass(validClass),i.addClass(errorClass)):(t.removeClass(validClass),t.addClass(errorClass))},unhighlight:function(n){var t=$(n),i;t.closest(".item-validate")?(i=t.closest(".item-validate"),i.removeClass(errorClass),i.addClass(validClass)):(t.removeClass(errorClass),t.addClass(validClass))},errorElement:"div",errorClass:"invalid-tooltip",errorPlacement:function(n,t){t.parent(".input-group-prepend").length?$(t).siblings(".invalid-feedback").append(n):t.hasClass("use-select2")?n.insertAfter(t.parent().find(".select2-selection")):t.hasClass("custom-control-input")?n.insertAfter($(".item-box div").last()):n.insertAfter(t)}});$.validator.addMethod("validphone",function(n,t){return this.optional(t)||/((09|03|07|08|05)+([0-9]{8})\b)/g.test(n)},"Vui lòng nhập số điện thoại hợp lệ");$.validator.addMethod("validTelephone",function(n,t){return this.optional(t)||/^[\+]?[(]?[0-9]{3,4}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/im.test(n)},"Vui lòng nhập số điện thoại hợp lệ");$.validator.addMethod("filesize",function(n,t,i){return this.optional(t)||t.files[0].size<=i});$.validator.addMethod("validIdCard",function(n,t){return this.optional(t)||/^[0-9]{9}$/.test(n)},"Vui lòng nhập số CMND hợp lệ");$.validator.addMethod("validIdCitizen",function(n,t){return this.optional(t)||/^[0-9]{12}$/.test(n)},"Vui lòng nhập số CCCD hợp lệ");$.validator.addMethod("validPassport",function(n,t){return this.optional(t)||/([A-Z]+([0-9]{7})\b)/g.test(n)},"Vui lòng nhập số thẻ Passport hợp lệ");$.validator.addMethod("validEvn",function(){return!0},"Vui lòng nhập mã KH EVN hợp lệ");$.validator.addMethod("validAccountNumber",function(n,t){return this.optional(t)||/^[0-9A-Z]{16}$/.test(n)},"Vui lòng nhập số tài khoản hợp lệ");$.validator.addMethod("validCardNumber",function(n,t){return this.optional(t)||/^[0-9]{16}$/.test(n)},"Vui lòng nhập số thẻ hợp lệ");$.fn.select2.defaults.set("theme","bootstrap");arrayNumber=["không","một","hai","ba","bốn","năm","sáu","bảy","tám","chín"];current=1;steps=$("fieldset").length;autoNumericOptions={digitGroupSeparator:".",decimalCharacter:",",decimalCharacterAlternative:",",decimalPlaces:0,minimumValue:1};