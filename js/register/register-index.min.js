(function(n){function i(){n("#step-1, #step-2, #step-3, #step-4, #step-5, #step-6, #step-6-1, #step-7").each(function(){n(this).find("input").val("");n(this).find("label.lbl-data").html("");n(this).find("select").find("option:eq(0)").prop("selected",!0);n(this).find(".msg").html("");n(this).find("div.evn-info").removeClass("display-none").addClass("display-none");n(this).find("table").removeClass("display-none").addClass("display-none")});n("#step-8").find("#btn-payinto, #btn-paywaiting, #btn-print").removeClass("display-none").addClass("display-none")}function r(t){if(t&&t.length>0){var i="";n.each(t,function(n,t){var e=t.cstRegId,r=t.customerName?t.customerName:"",u=t.customerPhone?t.customerPhone:"",o=t.customerIdentityType?t.customerIdentityType:"",s=t.customerIdentityTypeName?t.customerIdentityTypeName:"",f=t.customerIdentityNo?t.customerIdentityNo:"";i+=`<tr>
                                                <td class="text-center">${n+1}</td>
                                                <td class="text-left">${r}</td>
                                                <td class="text-left">${s}</td>
                                                <td class="text-center">${f}</td>
                                                <td class="text-center">${u}</td>
                                                <td class="text-center">${formatDate(t.regDate)}</td>
                                                <td class="text-center">
                                                    <button class="btn btn-sm btn-secondary btn-select-customer" title="Chọn"
                                                        data-id='${e}' data-name='${r}' data-phone='${u}' data-identity-type='${o}' data-identity-no='${f}'>
                                                        <i class="far fa-check-circle"></i> Chọn</button>
                                                </td>
                                            </tr>`});n("#step-1").find("table tbody").html("").html(i);n("#step-1").find("table").removeClass("display-none")}else n("#step-1").find("table").removeClass("display-none").addClass("display-none"),n("#step-1").find("table tbody").html("")}var t=n("#frm-check-customer"),u=n("#frm-bank");n(document).ready(function(){t.validate();n('input[name="FilterValue"]').keypress(function(t){var i=t.which;return i===13?(n("#btn-search-customer").click(),!1):!0});n(document).on("change","#cboFilter",function(){var t=n(this).val();n("#frm-search-customer").validate();n("#cboFilter").rules("remove","required");n("#cboFilter").rules("add",{required:!0,messages:{required:"Vui lòng chọn"}});t==="CMND"?(n("#txt-filter").rules("remove","validIdCitizen"),n("#txt-filter").rules("remove","validPassport"),n("#txt-filter").rules("remove","validEvn"),n("#txt-filter").rules("add",{required:!0,validIdCard:!0,messages:{required:"Vui lòng nhập"}})):t==="CCCD"?(n("#txt-filter").rules("remove","validIdCard"),n("#txt-filter").rules("remove","validPassport"),n("#txt-filter").rules("remove","validEvn"),n("#txt-filter").rules("add",{required:!0,validIdCitizen:!0,messages:{required:"Vui lòng nhập"}})):t==="PASSPORT"?(n("#txt-filter").rules("remove","validIdCard"),n("#txt-filter").rules("remove","validIdCitizen"),n("#txt-filter").rules("remove","validEvn"),n("#txt-filter").rules("add",{required:!0,validPassport:!0,messages:{required:"Vui lòng nhập"}})):t==="EVN"?(n("#txt-filter").rules("remove","validIdCard"),n("#txt-filter").rules("remove","validIdCitizen"),n("#txt-filter").rules("remove","validPassport"),n("#txt-filter").rules("add",{required:!0,validEvn:!0,messages:{required:"Vui lòng nhập"}})):(n("#txt-filter").rules("remove","validIdCard"),n("#txt-filter").rules("remove","validIdCitizen"),n("#txt-filter").rules("remove","validPassport"),n("#txt-filter").rules("remove","validEvn"),n("#txt-filter").rules("add",{required:!0,messages:{required:"Vui lòng nhập"}}))});n(document).on("click","#btn-search-customer",function(){i();var t=n("#frm-search-customer");return(t.validate({rules:{Filter:{required:!0},FilterValue:{required:!0}},messages:{Filter:{required:"Vui lòng chọn"},FilterValue:{required:"Vui lòng nhập"}}}),t.valid()===!0)?(n("#btn-register-customer").removeClass("display-none"),n.ajax({url:"/PayInto/GetCustomerList",type:"get",dataType:"json",data:{filter:n("select[name='Filter']").val(),filterValue:n.trim(n("input[name='FilterValue']").val())},success:function(t){if(t&&t.success===!0){var i=t.data;r(i);i.length>0?n("#step-1").find(".msg").html(""):n("#step-1").find(".msg").html("").html('<p class="text-danger"><strong>Không có KH nào thỏa điều kiện tìm kiếm<\/strong><\/p>')}else n("#step-1").find("table tbody").html(""),n("#step-1").find("table").removeClass("display-none").addClass("display-none"),n("#step-1").find(".msg").html("").html(`<p class="text-danger"><strong>${t.message}</strong></p>`)},error:function(n){console.log(n.responseText)}}),!0):!1})})})(jQuery);