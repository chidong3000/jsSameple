(function(n){function i(){n("#dtpFromDate").datetimepicker({locale:"vi",format:"DD/MM/YYYY",defaultDate:moment().add(-7,"days")});n("#dtpToDate").datetimepicker({locale:"vi",format:"DD/MM/YYYY",defaultDate:moment(),useCurrent:!1});n("#dtpFromDate").on("dp.change",function(t){n("#dtpToDate").data("DateTimePicker").minDate(t.date)});n("#dtpToDate").on("dp.change",function(t){n("#dtpFromDate").data("DateTimePicker").maxDate(t.date)})}function r(){if(n("#chkToday").is(":checked")===!1){if(n("#dtpFromDate").val()===""||n("#dtpToDate").val()==="")return notifyDanger("Vui lòng nhập từ ngày và đến ngày"),!1;var i=moment(n("#dtpFromDate").val(),"DD/MM/YYYY"),r=moment(n("#dtpToDate").val(),"DD/MM/YYYY"),t=moment.duration(r.diff(i));if(t.asDays()<0)return notifyDanger("Từ ngày không được nhỏ hơn đến ngày"),!1;if(t.asDays()>30)return notifyDanger("Từ ngày và đến ngày không cách nhau 30 ngày"),!1}return!0}function t(t){var i=n(".mvc-grid-pager-rows").val(),u,f;t||(t=1);i&&parseInt(i)!==0||(i=10);u=r();u===!0&&(f={areaCode:n("#cboBranchs").val(),branchCode:n("#cboAreas").val(),userId:n("#cboUsers").val(),filter:n("#cboFilter").val(),filterValue:n.trim(n("#txtFilterValue").val()),transType:n("#cboType").val(),transStatusCode:n("#cboStatus").val(),transDateFrom:n("#dtpFromDate").val(),transDateTo:n("#dtpToDate").val(),productCode:n("#cboProduct").val(),pageNo:t,pageSize:i,isPaging:1},n.ajax({url:"/search-trans-in-out",type:"get",dataType:"html",data:f,success:function(t){n("#data-grid").html(t)}}))}function u(){location.reload()}function f(t,i){n.ajax({dataType:"html",type:"get",url:"/SearchTransInOut/PrintInvoice",data:{transType:i,id:t},success:function(t){n("#data-invoice").html("").html(t);n("#data-invoice").print({globalStyles:!1,mediaPrint:!1,stylesheet:"/css/print-invoice.css",iframe:!1,noPrintSelector:".avoid-this",prepend:"",append:"",deferred:n.Deferred().done(function(){location.reload()})})}})}n(document).ready(function(){i();bindSearchInfoPartial();n(document).on("click","#btn-search",function(n){n.preventDefault();t()});n(document).on("click","#btn-refresh",function(n){n.preventDefault();u()});n(document).on("click",".grid-pager button",function(i){i.preventDefault();var r=n(this).attr("data-page");t(r)});n(document).on("click","#btn-print",function(){var t=n(this).data("id"),i=n(this).data("type");f(t,i)})})})(jQuery);