(function(n){function h(t){if(t&&t.length>0){var i="",r="";n.each(t,function(n,t){var o=t.cstRegId,u=t.customerName?t.customerName:"",f=t.customerPhone?t.customerPhone:"",s=t.customerIdentityType?t.customerIdentityType:"",h=t.customerIdentityTypeName?t.customerIdentityTypeName:"",e=t.customerIdentityNo?t.customerIdentityNo:"";r=t.totalBill?t.totalBill:"0";i+=`<tr>
                                                <td class="text-center">${n+1}</td>
                                                <td class="text-left">${u}</td>
                                                <td class="text-left">${h}</td>
                                                <td class="text-center">${e}</td>
                                                <td class="text-center">${f}</td>
                                                <td class="text-center">${formatDate(t.regDate)}</td>
                                                <td class="text-center">
                                                    <button class="btn btn-sm btn-secondary btn-select-customer" title="Chọn"
                                                        data-id='${o}' data-name='${u}' data-phone='${f}' data-identity-type='${s}' data-identity-no='${e}'>
                                                        <i class="far fa-check-circle"></i> Chọn</button>
                                                </td>
                                            </tr>`});n("#step-1").find("table tbody").html("").html(i);n("#step-1").find("table").removeClass("display-none");n("#totalBillReg").text(r)}else n("#step-1").find("table").removeClass("display-none").addClass("display-none"),n("#step-1").find("table tbody").html("")}function u(r){n("#txt-cst-name").val(r.name);n("#txt-cst-phone").val(r.phone);n("#cbo-cst-identity-type").val(r.identityType);n("#txt-cst-identity-no").val(r.identityNo);n("#btn-register-bank").attr("data-cst-id",r.id);n("#btn-register-service").attr("data-cst-id",r.id);t.cstregId=r.id;r&&r.id?(i(!0),n("#btn-check-customer").removeClass("display-none").addClass("display-none")):(i(!1),n("#btn-check-customer").removeClass("display-none"));n("#step-2").removeClass("display-none")}function c(t){t&&t.id?(n("#hd-cst-bank-id").val(t.id),n("#cbo-bank").val(t.bankCode),n("#cbo-bank-acc-type").val(t.bankAccType),n("#txt-bank-acc-no").val(t.accountNo)):(n("#hd-cst-bank-id").val(""),n("#cbo-bank").val(""),n("#cbo-bank-acc-type").val(n("#cbo-bank-acc-type option:first").val()),n("#txt-bank-acc-no").val(""))}function p(i){var r,u,f,e;i?(n("#txt-inning").val(i.inning),n("#txt-name").val(i.name),n("#txt-phone").val(i.phoneByProvider),n("#txt-typeName").val(i.cstPETypeName),n("#txt-address").val(i.address),t.custPeCode=n.trim(n("#txt-peCode").val()),t.custPeIdx=i.inning,t.custPeType=i.cstPEType,t.custPeName=i.name,t.custPeAddress=i.address,t.custPePhone=i.phoneByProvider,n(".evn-info").removeClass("display-none"),r=i.details,u=i.debit,r.length>0?(f="",n.each(r,function(n,t){f+=`<tr>
                                            <td class="text-center">${n+1}</td>
                                            <td class="text-left">${t.peCode?t.peCode:""}</td>
                                            <td class="text-left">${t.name?t.name:""}</td>
                                            <td class="text-left">${t.cstName?t.cstName:""}</td>
                                            <td class="text-left">${t.phoneNo?t.phoneNo:""}</td>
                                            <td class="text-left">${t.identify?t.identify:""}</td>
                                        </tr>`}),n("#step-6 table tbody").html("").html(f),n("#step-7").removeClass("display-none")):(n("#step-6 table tbody").html(""),n("#step-6").removeClass("display-none").addClass("display-none")),u.length>0?(e="",n.each(u,function(n,t){e+=`<tr>
                                                <td class="text-center">${n+1}</td>
                                                <td class="text-left">${t.peCode?t.peCode:""}</td>
                                                <td class="text-left">${t.name?t.name:""}</td>
                                                <td class="text-left">${t.address?t.address:""}</td>
                                                <td class="text-left">${t.period?t.period:""}</td>
                                                <td class="text-left">${t.debitType?t.debitType:""}</td>
                                                <td class="text-right">${formatNumber(t.debitAmt)}</td>
                                                <td class="text-center">${t.status?t.status:""}</td>
                                            </tr>`}),n("#step-6-1 table tbody").html("").html(e),n("#step-6-1").removeClass("display-none")):(n("#step-6-1 table tbody").html(""),n("#step-6-1").removeClass("display-none").addClass("display-none"))):(n("#txt-inning").val(""),n("#txt-name").val(""),n("#txt-phone").val(""),n("#txt-typeName").val(""),n("#txt-address").val(""),t.custPeCode=n.trim(n("#txt-peCode").val()),t.custPeIdx="",t.custPeType="",t.custPeName="",t.custPeAddress="",t.custPePhone="",n(".evn-info").removeClass("display-none").addClass("display-none"),n("#step-6 table tbody").html(""),n("#step-6").removeClass("display-none").addClass("display-none"),n("#step-6-1 table tbody").html(""),n("#step-6-1").removeClass("display-none").addClass("display-none"))}function r(t){t&&t===!0?(n("#btn-register-bank").removeClass("display-none"),n("#btn-register-service").removeClass("display-none")):(n("#btn-register-bank").removeClass("display-none").addClass("display-none"),n("#btn-register-service").removeClass("display-none").addClass("display-none"))}function i(t){t||(t=!1);n("#btn-check-customer").removeClass("display-none").addClass("display-none");n("#txt-cst-name").prop("disabled",t);n("#txt-cst-phone").prop("disabled",t);n("#cbo-cst-identity-type").prop("disabled",t);n("#txt-cst-identity-no").prop("disabled",t)}function l(){n("#step-1").find("table").removeClass("display-none").addClass("display-none");n("#step-1").find(".msg").html("");n("#step-1").each(function(){n(this).find("input").val("")});n("#step-2").removeClass("display-none").addClass("display-none");n("#step-2").find(".msg").html("");n("#step-3").removeClass("display-none").addClass("display-none");n("#step-3").find(".msg").html("");n("#step-4").removeClass("display-none").addClass("display-none");n("#step-4").find(".msg").html("");n("#step-5").removeClass("display-none").addClass("display-none");n("#step-5").find(".msg").html("");n("#step-5").each(function(){n(this).find("div.evn-info").removeClass("display-none").addClass("display-none")});n("#step-6").removeClass("display-none").addClass("display-none");n("#step-6").find(".msg").html("");n("#step-6-1").removeClass("display-none").addClass("display-none");n("#step-7").removeClass("display-none").addClass("display-none")}function a(){n("#step-1, #step-2, #step-3, #step-4, #step-5, #step-6, #step-7, #step-8").each(function(){n(this).find("input").val("");n(this).find("label.lbl-data").html("");n(this).find("select").find("option:eq(0)").prop("selected",!0)})}function f(){d();var t=n("input[name='DiscountPay']:checked").attr("data-value");t==="QT"?n("#cboGiftList").removeClass("display-none"):n("#cboGiftList").removeClass("display-none").addClass("display-none");n("#step-7").each(function(){n(this).find("input").val("");n(this).find("label.lbl-data").html("");n(this).find("select").find("option:eq(0)").prop("selected",!0)});n("#btn-payinto").removeClass("display-none").addClass("display-none");n("#btn-paywaiting").removeClass("display-none").addClass("display-none");n("#btn-print").removeClass("display-none").addClass("display-none")}function w(){var t=n("input[name='DiscountPay']:checked").attr("data-value");t==="QT"?n("#cboGiftList").removeClass("display-none"):n("#cboGiftList").removeClass("display-none").addClass("display-none");n("#step-7").each(function(){n(this).find("input.lbl-data").val("");n(this).find("label.lbl-data").html("")});n("#btn-payinto").removeClass("display-none").addClass("display-none");n("#btn-paywaiting").removeClass("display-none").addClass("display-none");n("#btn-print").removeClass("display-none").addClass("display-none")}function b(){var t=n("#cboProduct").val();e(t)}function e(t){var i=n("#cboPeriodType");i.html("");isEmpty(t)===!1&&n.ajax({dataType:"json",url:"/Dictionary/GetTermByProductId",data:{productId:t},success:function(r){if(r&&r.success===!0){var u=r.data;i.append(n("<option><\/option>").val("").html(defaultSelect));n.each(u,function(t,r){i.append(n("<option><\/option>").val(r.code).html(r.name))});k(t)}}})}function k(t){var i=n("#cboDiscountType");i.html("");isEmpty(t)===!1&&n.ajax({dataType:"json",url:"/Dictionary/GetDiscountTypeByProductId",data:{productId:t},success:function(t){if(t&&t.success===!0){var r=t.data;n.each(r,function(t,r){i.append(n("<option><\/option>").val(r.code).html(r.name))})}}})}function d(){n("#cboGiftList").html("");n("#txt-promoCode").val("");n.ajax({dataType:"json",url:"/Dictionary/GetGifts",data:{},success:function(t){if(t&&t.success===!0){var i=t.data;n("#cboGiftList").append(n("<option><\/option>").val("").html(defaultSelect));n.each(i,function(t,i){n("#cboGiftList").append(n(`<option data-name='${i.promoCode}'></option>`).val(i.giftCode).html(i.giftName))});v()}}})}function v(){n("#txt-promoCode").val(n("#cboGiftList option:selected").attr("data-name"))}function g(t,i){n.ajax({dataType:"html",type:"get",url:"/PayInto/PrintInvoicePayInto",data:{transType:t,id:i},success:function(t){n("#data-invoice").html("").html(t);n("#data-invoice").print({globalStyles:!1,mediaPrint:!1,stylesheet:"/css/print-invoice.css",iframe:!1,noPrintSelector:".avoid-this",prepend:"",append:"",deferred:n.Deferred().done(function(){location.reload()})})}})}function y(i){var r;if(t.transType=i,t.cstBankId=n("#hd-cst-bank-id").val(),t.bankCode=n("#cbo-bank").val(),t.accNoType=n("#cbo-bank-acc-type").val(),t.accountNo=n.trim(n("#txt-bank-acc-no").val()),t.custName=n.trim(n("#txt-cst-name").val()),t.custPhone=n.trim(n("#txt-cst-phone").val()),t.custIdentityType=n("#cbo-cst-identity-type").val(),t.custIdentify=n.trim(n("#txt-cst-identity-no").val()),t.giftCode=n("#cboGiftList").val(),t.promoCode=n("#txt-promoCode").val(),r=n("input[name='DiscountPay']:checked").attr("data-value"),r==="QT"&&t.giftCode==="")return notifyDanger("Vui lòng chọn quà tặng"),!1;if(s.valid()===!0){var u=t.paymentAmt,f=AutoNumeric.getAutoNumericElement("#txt-paymentAmt"),e=f.rawValue;Number(u)===Number(e)?n.ajax({url:"/PayInto/Register",type:"post",dataType:"json",data:t,success:function(t){t&&t.success===!0?(n("#btn-print").attr("data-id",t.data.result),i==="I"?n("#btn-print").removeClass("display-none"):n("#btn-print").removeClass("display-none").addClass("display-none"),n("#btn-payinto").removeClass("display-none").addClass("display-none"),n("#btn-paywaiting").removeClass("display-none").addClass("display-none"),notifySuccess(t.message)):notifyDanger(t.message)}}):notifyDanger("Số tiền cần tính toán không hợp lệ. Vui lòng tính toán lại")}else n("html, body").animate({scrollTop:n("#step-3").offset().top-60},500)}var t={},o=n("#frm-check-customer"),s=n("#frm-bank");n(document).ready(function(){o.validate();s.validate();b();n('input[name="FilterValue"]').keypress(function(t){var i=t.which;return i===13?(n("#btn-search-customer").click(),!1):!0});n(document).on("change","#cboFilter",function(){var t=n(this).val();n("#frm-search-customer").validate();n("#cboFilter").rules("remove","required");n("#cboFilter").rules("add",{required:!0,messages:{required:"Vui lòng chọn"}});t==="CMND"?(n("#txt-filter").rules("remove","validIdCitizen"),n("#txt-filter").rules("remove","validPassport"),n("#txt-filter").rules("remove","validEvn"),n("#txt-filter").rules("add",{required:!0,validIdCard:!0,messages:{required:"Vui lòng nhập"}})):t==="CCCD"?(n("#txt-filter").rules("remove","validIdCard"),n("#txt-filter").rules("remove","validPassport"),n("#txt-filter").rules("remove","validEvn"),n("#txt-filter").rules("add",{required:!0,validIdCitizen:!0,messages:{required:"Vui lòng nhập"}})):t==="PASSPORT"?(n("#txt-filter").rules("remove","validIdCard"),n("#txt-filter").rules("remove","validIdCitizen"),n("#txt-filter").rules("remove","validEvn"),n("#txt-filter").rules("add",{required:!0,validPassport:!0,messages:{required:"Vui lòng nhập"}})):t==="EVN"?(n("#txt-filter").rules("remove","validIdCard"),n("#txt-filter").rules("remove","validIdCitizen"),n("#txt-filter").rules("remove","validPassport"),n("#txt-filter").rules("add",{required:!0,validEvn:!0,messages:{required:"Vui lòng nhập"}})):(n("#txt-filter").rules("remove","validIdCard"),n("#txt-filter").rules("remove","validIdCitizen"),n("#txt-filter").rules("remove","validPassport"),n("#txt-filter").rules("remove","validEvn"),n("#txt-filter").rules("add",{required:!0,messages:{required:"Vui lòng nhập"}}))});n(document).on("change","#cbo-cst-identity-type",function(){var i=n(this).val(),r=n(this),t=n("#txt-cst-identity-no");r.rules("remove","required");r.rules("add",{required:!0,messages:{required:"Vui lòng chọn"}});i==="CMND"?(t.rules("remove","validIdCitizen"),t.rules("remove","validPassport"),t.rules("remove","validEvn"),t.rules("add",{required:!0,validIdCard:!0,messages:{required:"Vui lòng nhập"}})):i==="CCCD"?(t.rules("remove","validIdCard"),t.rules("remove","validPassport"),t.rules("remove","validEvn"),t.rules("add",{required:!0,validIdCitizen:!0,messages:{required:"Vui lòng nhập"}})):i==="PASSPORT"?(t.rules("remove","validIdCard"),t.rules("remove","validIdCitizen"),t.rules("remove","validEvn"),t.rules("add",{required:!0,validPassport:!0,messages:{required:"Vui lòng nhập"}})):(t.rules("remove","validIdCard"),t.rules("remove","validIdCitizen"),t.rules("remove","validPassport"),t.rules("remove","validEvn"),t.rules("add",{required:!0,messages:{required:"Vui lòng nhập"}}))});n(document).on("change","#cbo-bank",function(){var r=n(this).val(),t=n("#cbo-bank-acc-type"),i=n("#txt-bank-acc-no");isEmpty(r)===!0?(t.rules("remove","required"),i.rules("remove","required")):(t.rules("remove","required"),t.rules("add",{required:!0,messages:{required:"Vui lòng chọn"}}),i.rules("remove","required"),i.rules("add",{required:!0,messages:{required:"Vui lòng nhập"}}))});n(document).on("change","#cboProduct",function(){var t=n(this).val();e(t);f()});n(document).on("change","#cboProduct",function(){var t=n(this).val();e(t);f()});n(document).on("change","#cboGiftList",function(){v()});n(document).on("click","#btn-search-customer",function(){l();a();n("#chkpenone").prop("checked",!1);var t=n("#frm-search-customer");return(t.validate({rules:{Filter:{required:!0},FilterValue:{required:!0}},messages:{Filter:{required:"Vui lòng chọn"},FilterValue:{required:"Vui lòng nhập"}}}),t.valid()===!0)?(n("#btn-register-customer").removeClass("display-none"),n.ajax({url:"/PayInto/GetCustomerList",type:"get",dataType:"json",data:{filter:n("select[name='Filter']").val(),filterValue:n.trim(n("input[name='FilterValue']").val())},success:function(t){if(t&&t.success===!0){var i=t.data;h(i);i.length>0?n("#step-1").find(".msg").html(""):n("#step-1").find(".msg").html("").html('<p class="text-danger"><strong>Không có KH nào thỏa điều kiện tìm kiếm<\/strong><\/p>')}else n("#step-1").find("table tbody").html(""),n("#step-1").find("table").removeClass("display-none").addClass("display-none"),n("#step-1").find(".msg").html("").html(`<p class="text-danger"><strong>${t.message}</strong></p>`)},error:function(n){console.log(n.responseText)}}),!0):!1});n(document).on("click",".btn-select-customer",function(){var t=n(this),i={id:t.attr("data-id"),name:t.attr("data-name"),phone:t.attr("data-phone"),identityType:t.attr("data-identity-type"),identityNo:t.attr("data-identity-no")};r(!0);u(i)});n(document).on("click","#btn-check-customer",function(){n("#step-2").find(".msg").html("");r(!1);n("#txt-cst-name").rules("add",{required:!0,messages:{required:"Vui lòng nhập"}});n("#txt-cst-phone").rules("add",{required:!0,validphone:!0,messages:{required:"Vui lòng nhập"}});n("#cbo-cst-identity-type").rules("add",{required:!0,messages:{required:"Vui lòng chọn"}});n("#txt-cst-identity-no").rules("add",{required:!0,messages:{required:"Vui lòng nhập"}});o.valid()===!0&&n.ajax({url:"/PayInto/CheckCustomer",type:"get",dataType:"json",data:{phone:n.trim(n("#txt-cst-phone").val()),identityNo:n.trim(n("#txt-cst-identity-no").val())},success:function(t){var o;if(t&&t.success===!0){var f=t.data,e=f.items,s=f.isRegister;h(e);e.length>0&&s===!1?(n("#step-2").find(".msg").html("").html('<p class="text-danger"><strong>KH đã tồn tại trong hệ thống. Vui lòng chọn KH từ danh sách KH hiện có<\/strong><\/p>'),i(!0)):(n("#step-2").find(".msg").html("").html('<p class="text-success"><strong>Thông tin KH đăng ký mới hợp lệ<\/strong><\/p>'),r(!0));n("#btn-check-customer").removeClass("display-none").addClass("display-none")}else notifyDanger(t.message);o={id:"",name:n.trim(n("#txt-cst-name").val()),phone:n.trim(n("#txt-cst-phone").val()),identityType:n.trim(n("#cbo-cst-identity-type").val()),identityNo:n.trim(n("#txt-cst-identity-no").val())};u(o)},error:function(n){console.log(n.responseText)}})});n(document).on("click","#btn-register-customer",function(){n("#cboFilter").val("");n("#txt-filter").val("");n("#totalBillReg").text("0");l();a();r(!1);u({id:"",name:"",phone:"",identityType:"",identityNo:""})});n(document).on("click","#btn-register-bank",function(){i(!0);var t=n(this);n.ajax({url:"/PayInto/GetCustomerBank",type:"get",dataType:"json",data:{id:t.attr("data-cst-id")},success:function(t){var i,r;t&&t.success===!0?(n("#step-3").removeClass("display-none"),i=t.data,i.length>0?(r="",n.each(i,function(n,t){var e=t.cstBankId,i=t.bankCode?t.bankCode:"",u=t.bankName?t.bankName:"",o=t.bankAccType?t.bankAccType:"",s=t.bankAccTypeName?t.bankAccTypeName:"",f=t.accountNo?t.accountNo:"";r+=`<tr>
                                            <td class="text-center">${n+1}</td>
                                            <td class="text-center">${i}</td>
                                            <td class="text-left">${u}</td>
                                            <td class="text-center">${s}</td>
                                            <td class="text-center">${f}</td>
                                            <td class="text-center">
                                                <button class="btn btn-sm btn-secondary btn-select-bank" title="Chọn"
                                                    data-id='${e}' data-code='${i}' data-name='${u}' data-acc-type='${o}' data-acc-no='${f}'>
                                                    <i class="far fa-check-circle"></i> Chọn</button>
                                            </td>
                                        </tr>`}),n("#step-3").find("table").removeClass("display-none"),n("#step-3").find("table tbody").html("").html(r)):(n("#step-3").find("table").removeClass("display-none").addClass("display-none"),n("#step-3").find("table tbody").html(""))):notifyDanger(t.message)},error:function(n){console.log(n.responseText)}})});n(document).on("click",".btn-select-bank",function(){var t=n(this),i={id:t.attr("data-id"),bankCode:t.attr("data-code"),bankName:t.attr("data-name"),bankAccType:t.attr("data-acc-type"),accountNo:t.attr("data-acc-no")};c(i)});n(document).on("click","#btn-bank-refresh",function(){c()});n(document).on("input","#txt-bank-acc-no, #txt-cst-name",function(){var t=n(this),i=t[0].selectionStart;n(this).val(function(n,t){return t.toUpperCase()});t[0].selectionStart=t[0].selectionEnd=i});n(document).on("click","#btn-register-service",function(){n("#step-4").find("table tbody").html("");n("#step-4").removeClass("display-none").addClass("display-none");n("#step-5").removeClass("display-none");n("#oppenone").removeClass("display-none");i(!0);var r=n(this),t=r.attr("data-cst-id");t&&t!=="0"?n.ajax({url:"/PayInto/GetCustomerRegisted",type:"get",dataType:"json",data:{id:t},success:function(t){var i,r;t&&t.success===!0&&(i=t.data,i.length>0?(r="",n.each(i,function(n,t){var i=t.productName?t.productName:"",u=t.peCode?t.peCode:"",f=t.peName?t.peName:"",e=t.peAddress?t.peAddress:"",o=formatDate(t.registerDate),s=formatNumber(t.amount),h=t.periodName?t.periodName:"",c=formatNumber(t.periodAmount),l=t.refNo?t.refNo:"";r+=`<tr>
                                            <td class="text-center">${n+1}</td>
                                            <td class="text-left">${i}</td>
                                            <td class="text-center">${u}</td>
                                            <td class="text-left">${f}</td>
                                            <td class="text-left">${e}</td>
                                            <td class="text-center">${o}</td>
                                            <td class="text-right">${s}</td>
                                            <td class="text-center">${h}</td>
                                            <td class="text-right">${c}</td>
                                            <td class="text-center">${l}</td>
                                        </tr>`}),n("#step-4").find("table tbody").html("").html(r),n("#step-4").removeClass("display-none")):n("#step-2").find(".msg").html("").html('<p class="text-danger"><strong>Khách hàng hiện chưa tham gia dịch vụ<\/strong><\/p>'))},error:function(n){console.log(n.responseText)}}):n("#step-2").find(".msg").html("").html('<p class="text-danger"><strong>Khách hàng hiện chưa tham gia dịch vụ<\/strong><\/p>')});n(document).on("click","#btn-check-evn",function(){f();var t=n("#frm-check-evn");return(t.validate({rules:{PeCode:{required:!0}},messages:{PeCode:{required:"Vui lòng nhập"}}}),t.valid()===!0)?(n.ajax({url:"/PayInto/CheckEvn",type:"get",dataType:"json",data:{identity:n.trim(n("#txt-cst-identity-no").val()),evnCode:n.trim(n("#txt-peCode").val())},success:function(t){if(t&&t.success===!0){var r=t.data,u=r.details,i=!0;p(r);u.length>0&&(n.map(u,function(n){n.isRegister===!1&&(i=!1)}),i===!1&&n("#step-6").find(".msg").html("").html('<p class="text-danger"><strong>Mã điện đã được đăng ký tham gia CKSD-ĐBTT tại ECPAY<\/strong><\/p>'));i===!1?(n("#step-5").find(".msg").html("").html('<p class="text-danger"><strong>Mã điện không đủ điều kiện đăng ký CKSD-ĐBTT tại ECPAY<\/strong><\/p>'),n("#step-7").removeClass("display-none").addClass("display-none")):(n("#step-6").removeClass("display-none").addClass("display-none"),n("#step-6-1").removeClass("display-none").addClass("display-none"),n("#step-5").find(".msg").html(""),n("#step-7").removeClass("display-none"))}else notifyDanger(t.message)},error:function(n){console.log(n.responseText)}}),!0):!1});n(document).on("click","#btn-calculator",function(){var u=n("#form-payinto"),i,r,f;return(u.validate({rules:{Product:{required:!0},PaymentAmt:{required:!0},PeriodType:{required:!0},DiscountType:{required:!0},DiscountPay:{required:!0}},messages:{Product:{required:"Vui lòng chọn"},PaymentAmt:{required:"Vui lòng nhập"},PeriodType:{required:"Vui lòng chọn"},DiscountType:{required:"Vui lòng chọn"},DiscountPay:{required:"Vui lòng chọn"}}}),u.valid()===!0)?(i=AutoNumeric.getAutoNumericElement("#txt-paymentAmt"),r=i.rawValue,r<5e4||r%1e4!=0?(notifyDanger("Số tiền không hợp lệ. Số tiền tối thiểu: 50.000 vnd và là bội số của 10.000"),!1):(f={productId:n("#cboProduct").val(),paymentAmt:i.rawValue,periodType:n("#cboPeriodType").val(),discountType:n("#cboDiscountType").val(),discountPayType:n("input[name='DiscountPay']:checked").attr("data-value")},n.ajax({url:"/PayInto/CalcAmount",type:"post",dataType:"json",data:f,success:function(r){var u,f;r&&r.success===!0?(u=r.data,n("input[name='DiscountRate']").val(u.discountRate),n("input[name='DiscountAmt']").val(formatNumber(u.discountAmt)),n("input[name='AmtAverage']").val(formatNumber(u.amtAverage)),n("input[name='TotalAmtDue']").val(formatNumber(u.totalAmtDue)),n("label[name='TotalAmtDueWord']").html(u.totalAmtDueWord),n("input[name='DisburAmt']").val(formatNumber(u.disburAmt)),n("label[name='DisburAmtWord']").html(u.disburAmtWord),t.productId=n("#cboProduct").val(),t.paymentType="",t.paymentAmt=i.rawValue,t.periodType=n("#cboPeriodType").val(),t.discountType=n("#cboDiscountType").val(),t.discountPayType=n("input[name='DiscountPay']:checked").attr("data-value"),t.discountRate=u.discountRate,t.amtAverage=u.amtAverage,t.discountAmt=u.discountAmt,t.totalAmtDue=u.totalAmtDue,t.disburAmt=u.disburAmt,n("#btn-payinto").removeClass("display-none"),n("#btn-print").removeClass("display-none").addClass("display-none"),f=n("input[name='DiscountPay']:checked").attr("data-value"),f==="QT"?n("#btn-paywaiting").removeClass("display-none").addClass("display-none"):(n("#btn-paywaiting").removeClass("display-none"),n("#chkpenone").prop("checked")==!0?n("#btn-paywaiting").removeClass("display-none").addClass("display-none"):(n("#btn-payinto").removeClass("display-none"),n("#btn-paywaiting").removeClass("display-none")))):(n("#btn-payinto").removeClass("display-none").addClass("display-none"),n("#btn-paywaiting").removeClass("display-none").addClass("display-none"),n("#btn-print").removeClass("display-none").addClass("display-none"),notifyDanger(r.message))}}),!0)):!1});n(document).on("click","#btn-payinto",function(){var t=n(this),i=t.attr("data-trans-type");y(i)});n(document).on("click","#btn-paywaiting",function(){var t=n(this),i=t.attr("data-trans-type");y(i)});n(document).on("click","#btn-print",function(){var t=n(this),i=t.attr("data-id"),r=t.attr("data-trans-type");g(r,i)});n(document).on("click","#btn-refresh",function(){n.confirm({title:"Xác nhận?",content:"Bạn muốn làm mới?",type:"red",typeAnimated:!0,buttons:{tryAgain:{text:"Đồng ý",btnClass:"btn-red",action:function(){location.reload()}},close:{text:"Hủy",action:function(){}}}})});n(document).on("change","#txt-paymentAmt, #cboPeriodType, #cboDiscountType, input[name='DiscountPay']",function(){w()});n(document).on("click","#chkpenone",function(){n(this).is(":checked")?(n("#step-7").removeClass("display-none"),n("#oppenone").removeClass("display-none").addClass("display-none"),n(".evn-info").removeClass("display-none").addClass("display-none"),n("#btn-paywaiting").removeClass("display-none").addClass("display-none"),n("#txt-inning").val(""),n("#txt-name").val(""),n("#txt-phone").val(""),n("#txt-typeName").val(""),n("#txt-address").val(""),n("#txt-peCode").val(""),t.custPeCode="",t.custPeIdx="",t.custPeType="",t.custPeName="",t.custPeAddress="",t.custPePhone=""):(n("#step-7").removeClass("display-none").addClass("display-none"),n("#oppenone").removeClass("display-none"),n("#btn-payinto").removeClass("display-none").addClass("display-none"))})})})(jQuery);